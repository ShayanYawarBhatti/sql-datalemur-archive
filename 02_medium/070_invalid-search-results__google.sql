-- Title: Invalid Search Results
-- Company: Google
-- Difficulty: Medium
-- Access: Premium
-- Pattern: data quality filtering
-- Summary: Identify invalid search results by applying validity rules (NULLs, mismatched ids, missing links) and returning affected queries/results.
-- Notes: Encode validation conditions explicitly; use NOT EXISTS for missing reference rows; be careful with NULL comparisons.
-- Dialect: PostgreSQL
